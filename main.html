<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS Query Practice</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        h1 {
            margin: 0;
        }

        main {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 800px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview, .code-box {
            border: 1px dashed #ccc;
            padding: 10px;
            margin: 10px 0;
        }

        .preview {
            min-height: 200px;
        }

        .input-box {
            margin-bottom: 10px;
        }
        
        .preview, .code-box {
            flex: 1;
        }

        button, textarea {
            width: 100%;
        }

        @media (min-width: 768px) {
            main {
                flex-direction: row;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ðŸ¥¥</h1>

        <nav>
            <a href="javascript:randomChallenge();">Random</a>
            <a href="css.html">Flex</a>
        </nav>
    </header>
    <main>
        <div class="code-box">
            <p id="challenge-description"></p>
            <pre id="challenge-code"></pre>
            <textarea id="user-code" class="input-box" rows="5" placeholder="Write your CSS code here"></textarea>
            <button onclick="resetCss()">Reset</button>
            <p id="feedback"></p>
        </div>
        <div class="preview" id="preview-box">
            <iframe id="preview-iframe" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </main>
    
    <script>
        const challenges = [
            {
                description: "Add a background color to the preview box to red",
                htmlSnippet: `<div class="preview" id="preview-box">\n    <p>Styled Element</p>\n</div>`,
                cssSnippet: `.preview {\n    /* missing property */\n}`,
                answer: `.preview {\n    background-color: lightblue;\n}`
            },
            {
                description: "Make the preview box corners rounded to 10px",
                htmlSnippet: `<div class="preview" id="preview-box">\n    <p>Styled Element</p>\n</div>`,
                cssSnippet: `.preview {\n    /* missing property */\n}`,
                answer: `.preview {\n    border-radius: 10px;\n}`
            },
            {
                description: "Change the text color inside the preview box to red",
                htmlSnippet: `<div class="preview" id="preview-box">\n    <p>Styled Element</p>\n</div>`,
                cssSnippet: `.preview p {\n    /* missing property */\n}`,
                answer: `.preview p {\n    color: red;\n}`
            }
        ];

        const iframe = document.getElementById('preview-iframe');
        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        let currentChallenge = null;

        window.onload = () => {
            randomChallenge();
        };

        document.getElementById('user-code').addEventListener('input', () => {
            const userCode = document.getElementById('user-code').value.trim();
            const feedback = document.getElementById('feedback');

            const styleElement = iframeDoc.getElementById('user-style') || iframeDoc.createElement('style');
            styleElement.id = 'user-style';
            styleElement.textContent = userCode;
            iframeDoc.head.appendChild(styleElement);

            if (userCode === currentChallenge.answer) {
                feedback.textContent = "Correct!";
                feedback.style.color = "green";
            } else {
                feedback.textContent = "Incorrect";
                feedback.style.color = "red";
            }
        });

        function resetCss() {
            document.getElementById('user-code').value = currentChallenge.cssSnippet;
            document.getElementById('feedback').textContent = "";

            const styleElement = iframeDoc.getElementById('user-style');
            if (styleElement) {
                styleElement.remove();
            }
        }

        function randomChallenge() {
            currentChallenge = challenges[Math.floor(Math.random() * challenges.length)];
            document.getElementById('challenge-description').textContent = currentChallenge.description;
            document.getElementById('user-code').value = currentChallenge.cssSnippet;

            resetCss();

            iframeDoc.open();
            iframeDoc.write(`
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <style>${currentChallenge.cssSnippet}</style>
                </head>
                <body>
                    ${currentChallenge.htmlSnippet}
                </body>
                </html>
            `);
            iframeDoc.close();
        }
    </script>
</body>
</html>